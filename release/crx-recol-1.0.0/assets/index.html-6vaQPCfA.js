import{r as n,j as e,c as T}from"./client-BjeeCjb0.js";import{M as N}from"./messages-CFBAHGQi.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))d(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&d(i)}).observe(document,{childList:!0,subtree:!0});function u(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function d(s){if(s.ep)return;s.ep=!0;const a=u(s);fetch(s.href,a)}})();function x(t){if(t===0)return"0 B";const o=1024,u=["B","KB","MB","GB"],d=Math.floor(Math.log(t)/Math.log(o));return`${(t/Math.pow(o,d)).toFixed(2)} ${u[d]}`}function v(t){return t<1?`${t.toFixed(3)} ms`:t<1e3?`${t.toFixed(2)} ms`:`${(t/1e3).toFixed(2)} s`}function k(){const[t,o]=n.useState(null),[u,d]=n.useState(!0),[s,a]=n.useState(!1),[i,h]=n.useState(!1),[m,l]=n.useState(null);n.useEffect(()=>{b();const r=setInterval(b,5e3);return()=>clearInterval(r)},[]),n.useEffect(()=>{if(m){const r=setTimeout(()=>l(null),3e3);return()=>clearTimeout(r)}},[m]);const b=()=>{chrome.runtime.sendMessage({action:N.GET_STATISTICS},r=>{r&&(o(r),d(!1))})},S=()=>{a(!0),chrome.runtime.sendMessage({action:N.EXPORT_DATA},r=>{if(a(!1),r?.success){const j=JSON.stringify(r.data,null,2),g=new Blob([j],{type:"application/json"}),f=URL.createObjectURL(g),c=document.createElement("a");c.href=f,c.download=`recol-backup-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(f),l({type:"success",text:"Data exported successfully!"})}else l({type:"error",text:"Export failed: "+(r?.error||"Unknown error")})})},w=()=>{const r=document.createElement("input");r.type="file",r.accept="application/json",r.onchange=j=>{const g=j.target.files?.[0];if(!g)return;h(!0);const f=new FileReader;f.onload=c=>{try{const y=JSON.parse(c.target?.result);chrome.runtime.sendMessage({action:N.IMPORT_DATA,data:y},p=>{h(!1),p?.success?(l({type:"success",text:`Imported ${p.imported.links} links, ${p.imported.collections} collections`}),b()):l({type:"error",text:"Import failed: "+(p?.error||"Unknown error")})})}catch{h(!1),l({type:"error",text:"Invalid JSON file"})}},f.readAsText(g)},r.click()};return u?e.jsx("div",{className:"w-80 p-6 bg-background text-foreground",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("div",{className:"text-sm text-foreground/60",children:"Loading statistics..."})})}):t?e.jsxs("div",{className:"w-80 bg-background text-foreground",children:[e.jsx("div",{className:"p-6 pb-4 border-b border-border-subtle",children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-semibold text-foreground",children:"Recol Stats"}),e.jsx("p",{className:"text-xs text-foreground/50",children:"Instant Recall"})]})})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h2",{className:"text-xs font-semibold text-foreground/70 uppercase tracking-wide",children:"Data Management"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:S,disabled:s,className:"py-2.5 px-4 rounded-lg bg-secondary/30 border border-border-subtle hover:bg-secondary/50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-xs text-foreground/80 font-medium",children:s?"Exporting...":"Export Data"}),e.jsx("button",{onClick:w,disabled:i,className:"py-2.5 px-4 rounded-lg bg-secondary/30 border border-border-subtle hover:bg-secondary/50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-xs text-foreground/80 font-medium",children:i?"Importing...":"Import Data"})]}),e.jsx("p",{className:"text-[10px] text-foreground/40 text-center",children:"Backup your links and collections as JSON"})]}),m&&e.jsx("div",{className:`p-3 rounded-lg border ${m.type==="success"?"bg-foreground/5 border-foreground/20 text-foreground/80":"bg-red-500/10 border-red-500/30 text-red-400"}`,children:e.jsx("p",{className:"text-xs text-center",children:m.text})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h2",{className:"text-xs font-semibold text-foreground/70 uppercase tracking-wide",children:"Database"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"p-4 rounded-lg bg-secondary/30 border border-border-subtle",children:[e.jsx("div",{className:"text-2xl font-bold text-foreground",children:t.linksCount}),e.jsx("div",{className:"text-xs text-foreground/60 mt-1",children:"Total Links"})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-secondary/30 border border-border-subtle",children:[e.jsx("div",{className:"text-2xl font-bold text-foreground",children:t.collectionsCount}),e.jsx("div",{className:"text-xs text-foreground/60 mt-1",children:"Collections"})]})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-secondary/30 border border-border-subtle space-y-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex items-baseline gap-2",children:e.jsx("div",{className:"text-xl font-bold text-foreground",children:x(t.storageDetails.dataSize)})}),e.jsx("div",{className:"text-xs text-foreground/60",children:"Actual Data Size"})]}),e.jsxs("div",{className:"pt-2 border-t border-border-subtle/50 space-y-1.5 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-foreground/50",children:"Links data"}),e.jsx("span",{className:"text-foreground/70 font-medium",children:x(t.storageDetails.linksSize)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-foreground/50",children:"Collections"}),e.jsx("span",{className:"text-foreground/70 font-medium",children:x(t.storageDetails.collectionsSize)})]}),t.linksCount>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-foreground/50",children:"Avg per link"}),e.jsx("span",{className:"text-foreground/70 font-medium",children:x(t.storageDetails.averagePerLink)})]}),t.storageDetails.largestLink>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-foreground/50",children:"Largest link"}),e.jsx("span",{className:"text-foreground/70 font-medium",children:x(t.storageDetails.largestLink)})]})]}),t.storageDetails.totalExtensionStorage>0&&e.jsxs("div",{className:"pt-2 border-t border-border-subtle/50",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-foreground/40",children:"Total ext. storage"}),e.jsx("span",{className:"text-foreground/50",children:x(t.storageDetails.totalExtensionStorage)})]}),e.jsx("p",{className:"text-[10px] text-foreground/30 mt-1",children:"Includes IndexedDB overhead + cache"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h2",{className:"text-xs font-semibold text-foreground/70 uppercase tracking-wide",children:"Search Performance"}),e.jsxs("div",{className:"p-4 rounded-lg bg-secondary/30 border border-border-subtle space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-foreground/60",children:"Total Searches"}),e.jsx("span",{className:"text-sm font-semibold text-foreground",children:t.searchMetrics.totalSearches})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-foreground/60",children:"Average Time"}),e.jsx("span",{className:"text-sm font-semibold text-foreground",children:v(t.searchMetrics.averageTime)})]}),t.searchMetrics.lastSearchTime>0&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-foreground/60",children:"Last Search"}),e.jsx("span",{className:"text-sm font-semibold text-foreground",children:v(t.searchMetrics.lastSearchTime)})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-border-subtle",children:[e.jsx("span",{className:"text-xs text-foreground/60",children:"Total Time"}),e.jsx("span",{className:"text-xs text-foreground/50",children:v(t.searchMetrics.totalTime)})]})]})]}),e.jsx("div",{className:"p-3 rounded-lg bg-foreground/5 border border-foreground/10",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-foreground/60 animate-pulse"}),e.jsx("span",{className:"text-xs text-foreground/70",children:t.searchMetrics.averageTime<10?"⚡ Lightning fast searches":t.searchMetrics.averageTime<50?"✓ Good performance":"⚠️ Consider optimizing database"})]})}),e.jsx("div",{className:"pt-2 text-center",children:e.jsx("p",{className:"text-xs text-foreground/40",children:"Stats update every 5 seconds"})})]})]}):e.jsx("div",{className:"w-80 p-6 bg-background text-foreground",children:e.jsx("div",{className:"text-sm text-foreground/60",children:"No data available"})})}T.createRoot(document.getElementById("root")).render(e.jsx(n.StrictMode,{children:e.jsx(k,{})}));
